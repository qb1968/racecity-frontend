{"ast":null,"code":"import _slicedToArray from\"D:\\\\Dustin\\\\racecity-frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import Layout from'../core/Layout';import{isAuthenticated}from'../auth';import{Link}from'react-router-dom';import{getPurchaseHistory}from'./apiUser';import moment from'moment';var Dashboard=function Dashboard(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),history=_useState2[0],setHistory=_useState2[1];var _isAuthenticated=isAuthenticated(),_isAuthenticated$user=_isAuthenticated.user,_id=_isAuthenticated$user._id,name=_isAuthenticated$user.name,email=_isAuthenticated$user.email,role=_isAuthenticated$user.role;var token=isAuthenticated().token;var init=function init(userId,token){getPurchaseHistory(userId,token).then(function(data){if(data.error){console.log(data.error);}else{setHistory(data);}});};useEffect(function(){init(_id,token);},[]);var userLinks=function userLinks(){return/*#__PURE__*/React.createElement(\"div\",{className:\"card\"},/*#__PURE__*/React.createElement(\"h4\",{className:\"card-header\"},\"User links\"),/*#__PURE__*/React.createElement(\"ul\",{className:\"list-group\"},/*#__PURE__*/React.createElement(\"li\",{className:\"list-group-item\"},/*#__PURE__*/React.createElement(Link,{className:\"nav-link\",to:\"/cart\"},\"My cart\")),/*#__PURE__*/React.createElement(\"li\",{className:\"list-group-item\"},/*#__PURE__*/React.createElement(Link,{className:\"nav-link\",to:\"/profile/\".concat(_id)},\"Update profile\"))));};var userInfo=function userInfo(){return/*#__PURE__*/React.createElement(\"div\",{className:\"card mb-5\"},/*#__PURE__*/React.createElement(\"h3\",{className:\"card-header\"},\"User information\"),/*#__PURE__*/React.createElement(\"ul\",{className:\"list-group\"},/*#__PURE__*/React.createElement(\"li\",{className:\"list-group-item\"},name),/*#__PURE__*/React.createElement(\"li\",{className:\"list-group-item\"},email),/*#__PURE__*/React.createElement(\"li\",{className:\"list-group-item\"},role===1?'Admin':'Registered user')));};var purchaseHistory=function purchaseHistory(history){return/*#__PURE__*/React.createElement(\"div\",{className:\"card mb-5\"},/*#__PURE__*/React.createElement(\"h3\",{className:\"card-header\"},\"Purchase history\"),/*#__PURE__*/React.createElement(\"ul\",{className:\"list-group\"},/*#__PURE__*/React.createElement(\"li\",{className:\"list-group-item\"},history.map(function(h,i){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"hr\",null),h.products.map(function(p,i){return/*#__PURE__*/React.createElement(\"div\",{key:i},/*#__PURE__*/React.createElement(\"h6\",null,\"Product name: \",p.name),/*#__PURE__*/React.createElement(\"h6\",null,\"Product price: $\",p.price),/*#__PURE__*/React.createElement(\"h6\",null,\"Purchased date: \",moment(p.createdAt).fromNow()));}));}))));};return/*#__PURE__*/React.createElement(Layout,{title:\"Dashboard\",description:\"\".concat(name),className:\"container-fluid\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-3\"},userLinks()),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-9\"},userInfo(),purchaseHistory(history))));};export default Dashboard;","map":{"version":3,"sources":["D:/Dustin/racecity-frontend/src/user/UserDashboard.js"],"names":["React","useState","useEffect","Layout","isAuthenticated","Link","getPurchaseHistory","moment","Dashboard","history","setHistory","user","_id","name","email","role","token","init","userId","then","data","error","console","log","userLinks","userInfo","purchaseHistory","map","h","i","products","p","price","createdAt","fromNow"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport Layout from '../core/Layout';\r\nimport { isAuthenticated } from '../auth';\r\nimport { Link } from 'react-router-dom';\r\nimport { getPurchaseHistory } from './apiUser';\r\nimport moment from 'moment';\r\n\r\nconst Dashboard = () => {\r\n  const [history, setHistory] = useState([]);\r\n\r\n  const {\r\n    user: { _id, name, email, role },\r\n  } = isAuthenticated();\r\n\r\n  const token = isAuthenticated().token;\r\n\r\n  const init = (userId, token) => {\r\n    getPurchaseHistory(userId, token).then((data) => {\r\n      if (data.error) {\r\n        console.log(data.error);\r\n      } else {\r\n        setHistory(data);\r\n      }\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    init(_id, token);\r\n  }, []);\r\n\r\n  const userLinks = () => {\r\n    return (\r\n      <div className='card'>\r\n        <h4 className='card-header'>User links</h4>\r\n        <ul className='list-group'>\r\n          <li className='list-group-item'>\r\n            <Link className='nav-link' to='/cart'>\r\n              My cart\r\n            </Link>\r\n          </li>\r\n          <li className='list-group-item'>\r\n            <Link className='nav-link' to={`/profile/${_id}`}>\r\n              Update profile\r\n            </Link>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const userInfo = () => {\r\n    return (\r\n      <div className='card mb-5'>\r\n        <h3 className='card-header'>User information</h3>\r\n        <ul className='list-group'>\r\n          <li className='list-group-item'>{name}</li>\r\n          <li className='list-group-item'>{email}</li>\r\n          <li className='list-group-item'>\r\n            {role === 1 ? 'Admin' : 'Registered user'}\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const purchaseHistory = (history) => {\r\n    return (\r\n      <div className='card mb-5'>\r\n        <h3 className='card-header'>Purchase history</h3>\r\n        <ul className='list-group'>\r\n          <li className='list-group-item'>\r\n            {history.map((h, i) => {\r\n              return (\r\n                <div>\r\n                  <hr />\r\n                  {h.products.map((p, i) => {\r\n                    return (\r\n                      <div key={i}>\r\n                        <h6>Product name: {p.name}</h6>\r\n                        <h6>Product price: ${p.price}</h6>\r\n                        <h6>Purchased date: {moment(p.createdAt).fromNow()}</h6>\r\n                      </div>\r\n                    );\r\n                  })}\r\n                </div>\r\n              );\r\n            })}\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <Layout\r\n      title='Dashboard'\r\n      description={`${name}`}\r\n      className='container-fluid'\r\n    >\r\n      <div className='row'>\r\n        <div className='col-md-3'>{userLinks()}</div>\r\n        <div className='col-md-9'>\r\n          {userInfo()}\r\n          {purchaseHistory(history)}\r\n        </div>\r\n      </div>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default Dashboard;\r\n"]},"metadata":{},"sourceType":"module"}