{"ast":null,"code":"import _slicedToArray from\"D:\\\\Dustin\\\\racecity-frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import Layout from'../core/Layout';import{isAuthenticated}from'../auth';import{Link}from'react-router-dom';import{listOrders,getStatusValues,updateOrderStatus}from'./apiAdmin';import moment from'moment';var Orders=function Orders(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),orders=_useState2[0],setOrders=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),statusValues=_useState4[0],setStatusValues=_useState4[1];var _isAuthenticated=isAuthenticated(),user=_isAuthenticated.user,token=_isAuthenticated.token;var loadOrders=function loadOrders(){listOrders(user._id,token).then(function(data){if(data.error){console.log(data.error);}else{setOrders(data);}});};var loadStatusValues=function loadStatusValues(){getStatusValues(user._id,token).then(function(data){if(data.error){console.log(data.error);}else{setStatusValues(data);}});};useEffect(function(){loadOrders();loadStatusValues();},[]);var showOrdersLength=function showOrdersLength(){if(orders.length>0){return/*#__PURE__*/React.createElement(\"h1\",{className:\"text-danger display-2\"},\"Total orders: \",orders.length);}else{return/*#__PURE__*/React.createElement(\"h1\",{className:\"text-danger\"},\"No orders\");}};var showInput=function showInput(key,value){return/*#__PURE__*/React.createElement(\"div\",{className:\"input-group mb-2 mr-sm-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-group-prepend\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-group-text\"},key)),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",value:value,className:\"form-control\",readOnly:true}));};var handleStatusChange=function handleStatusChange(e,orderId){updateOrderStatus(user._id,token,orderId,e.target.value).then(function(data){if(data.error){console.log('Status update failed');}else{loadOrders();}});// console.log('update order status');\n};var showStatus=function showStatus(o){return/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"h3\",{className:\"mark mb-4\"},\"Status: \",o.status),/*#__PURE__*/React.createElement(\"select\",{className:\"form-control\",onChange:function onChange(e){return handleStatusChange(e,o._id);}},/*#__PURE__*/React.createElement(\"option\",null,\"Update Status\"),statusValues.map(function(status,index){return/*#__PURE__*/React.createElement(\"option\",{key:index,value:status},status);})));};return/*#__PURE__*/React.createElement(Layout,{title:\"Orders\",description:\"Hey \".concat(user.name,\", you can manage all the ordes here\")},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-8 offset-md-2\"},showOrdersLength(),orders.map(function(o,oIndex){return/*#__PURE__*/React.createElement(\"div\",{className:\"mt-5\",key:oIndex,style:{borderBottom:'5px solid indigo'}},/*#__PURE__*/React.createElement(\"h2\",{className:\"mb-5\"},/*#__PURE__*/React.createElement(\"span\",{className:\"bg-primary\"},\"Order ID: \",o._id)),/*#__PURE__*/React.createElement(\"ul\",{className:\"list-group mb-2\"},/*#__PURE__*/React.createElement(\"li\",{className:\"list-group-item\"},showStatus(o)),/*#__PURE__*/React.createElement(\"li\",{className:\"list-group-item\"},\"Transaction ID: \",o.transaction_id),/*#__PURE__*/React.createElement(\"li\",{className:\"list-group-item\"},\"Amount: $\",o.amount),/*#__PURE__*/React.createElement(\"li\",{className:\"list-group-item\"},\"Ordered by: \",o.user.name),/*#__PURE__*/React.createElement(\"li\",{className:\"list-group-item\"},\"Ordered on: \",moment(o.createdAt).fromNow()),/*#__PURE__*/React.createElement(\"li\",{className:\"list-group-item\"},\"Delivery address: \",o.address)),/*#__PURE__*/React.createElement(\"h3\",{className:\"mt-4 mb-4 font-italic\"},\"Total products in the order: \",o.products.length),o.products.map(function(p,pIndex){return/*#__PURE__*/React.createElement(\"div\",{className:\"mb-4\",key:pIndex,style:{padding:'20px',border:'1px solid indigo'}},showInput('Product name',p.name),showInput('Product price',p.price),showInput('Product total',p.count),showInput('Product Id',p._id));}));}))));};export default Orders;","map":{"version":3,"sources":["D:/Dustin/racecity-frontend/src/admin/Orders.js"],"names":["React","useState","useEffect","Layout","isAuthenticated","Link","listOrders","getStatusValues","updateOrderStatus","moment","Orders","orders","setOrders","statusValues","setStatusValues","user","token","loadOrders","_id","then","data","error","console","log","loadStatusValues","showOrdersLength","length","showInput","key","value","handleStatusChange","e","orderId","target","showStatus","o","status","map","index","name","oIndex","borderBottom","transaction_id","amount","createdAt","fromNow","address","products","p","pIndex","padding","border","price","count"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport Layout from '../core/Layout';\r\nimport { isAuthenticated } from '../auth';\r\nimport { Link } from 'react-router-dom';\r\nimport { listOrders, getStatusValues, updateOrderStatus } from './apiAdmin';\r\nimport moment from 'moment';\r\n\r\nconst Orders = () => {\r\n  const [orders, setOrders] = useState([]);\r\n  const [statusValues, setStatusValues] = useState([]);\r\n  const { user, token } = isAuthenticated();\r\n\r\n  const loadOrders = () => {\r\n    listOrders(user._id, token).then((data) => {\r\n      if (data.error) {\r\n        console.log(data.error);\r\n      } else {\r\n        setOrders(data);\r\n      }\r\n    });\r\n  };\r\n\r\n  const loadStatusValues = () => {\r\n    getStatusValues(user._id, token).then((data) => {\r\n      if (data.error) {\r\n        console.log(data.error);\r\n      } else {\r\n        setStatusValues(data);\r\n      }\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    loadOrders();\r\n    loadStatusValues();\r\n  }, []);\r\n\r\n  const showOrdersLength = () => {\r\n    if (orders.length > 0) {\r\n      return (\r\n        <h1 className='text-danger display-2'>Total orders: {orders.length}</h1>\r\n      );\r\n    } else {\r\n      return <h1 className='text-danger'>No orders</h1>;\r\n    }\r\n  };\r\n\r\n  const showInput = (key, value) => (\r\n    <div className='input-group mb-2 mr-sm-2'>\r\n      <div className='input-group-prepend'>\r\n        <div className='input-group-text'>{key}</div>\r\n      </div>\r\n      <input type='text' value={value} className='form-control' readOnly />\r\n    </div>\r\n  );\r\n\r\n  const handleStatusChange = (e, orderId) => {\r\n    updateOrderStatus(user._id, token, orderId, e.target.value).then((data) => {\r\n      if (data.error) {\r\n        console.log('Status update failed');\r\n      } else {\r\n        loadOrders();\r\n      }\r\n    });\r\n    // console.log('update order status');\r\n  };\r\n\r\n  const showStatus = (o) => (\r\n    <div className='form-group'>\r\n      <h3 className='mark mb-4'>Status: {o.status}</h3>\r\n      <select\r\n        className='form-control'\r\n        onChange={(e) => handleStatusChange(e, o._id)}\r\n      >\r\n        <option>Update Status</option>\r\n        {statusValues.map((status, index) => (\r\n          <option key={index} value={status}>\r\n            {status}\r\n          </option>\r\n        ))}\r\n      </select>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <Layout\r\n      title='Orders'\r\n      description={`Hey ${user.name}, you can manage all the ordes here`}\r\n    >\r\n      <div className='row'>\r\n        <div className='col-md-8 offset-md-2'>\r\n          {showOrdersLength()}\r\n\r\n          {orders.map((o, oIndex) => {\r\n            return (\r\n              <div\r\n                className='mt-5'\r\n                key={oIndex}\r\n                style={{ borderBottom: '5px solid indigo' }}\r\n              >\r\n                <h2 className='mb-5'>\r\n                  <span className='bg-primary'>Order ID: {o._id}</span>\r\n                </h2>\r\n\r\n                <ul className='list-group mb-2'>\r\n                  <li className='list-group-item'>{showStatus(o)}</li>\r\n                  <li className='list-group-item'>\r\n                    Transaction ID: {o.transaction_id}\r\n                  </li>\r\n                  <li className='list-group-item'>Amount: ${o.amount}</li>\r\n                  <li className='list-group-item'>Ordered by: {o.user.name}</li>\r\n                  <li className='list-group-item'>\r\n                    Ordered on: {moment(o.createdAt).fromNow()}\r\n                  </li>\r\n                  <li className='list-group-item'>\r\n                    Delivery address: {o.address}\r\n                  </li>\r\n                </ul>\r\n\r\n                <h3 className='mt-4 mb-4 font-italic'>\r\n                  Total products in the order: {o.products.length}\r\n                </h3>\r\n\r\n                {o.products.map((p, pIndex) => (\r\n                  <div\r\n                    className='mb-4'\r\n                    key={pIndex}\r\n                    style={{ padding: '20px', border: '1px solid indigo' }}\r\n                  >\r\n                    {showInput('Product name', p.name)}\r\n                    {showInput('Product price', p.price)}\r\n                    {showInput('Product total', p.count)}\r\n                    {showInput('Product Id', p._id)}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default Orders;\r\n"]},"metadata":{},"sourceType":"module"}