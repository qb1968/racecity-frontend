{"ast":null,"code":"import _defineProperty from\"D:\\\\Dustin\\\\racecity-frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _objectSpread from\"D:\\\\Dustin\\\\racecity-frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"D:\\\\Dustin\\\\racecity-frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{Redirect,Link}from'react-router-dom';import Layout from'../core/Layout';import Avatar from'@material-ui/core/Avatar';import Button from'@material-ui/core/Button';import CssBaseline from'@material-ui/core/CssBaseline';import TextField from'@material-ui/core/TextField';import FormControlLabel from'@material-ui/core/FormControlLabel';import Checkbox from'@material-ui/core/Checkbox';import Grid from'@material-ui/core/Grid';import Box from'@material-ui/core/Box';import LockOutlinedIcon from'@material-ui/icons/LockOutlined';import Typography from'@material-ui/core/Typography';import{makeStyles}from'@material-ui/core/styles';import Container from'@material-ui/core/Container';import Copyright from'../core/Copyright';import{signin,authenticate,isAuthenticated}from'../auth';var useStyles=makeStyles(function(theme){return{paper:{marginTop:theme.spacing(8),display:'flex',flexDirection:'column',alignItems:'center'},avatar:{margin:theme.spacing(1),backgroundColor:theme.palette.secondary.main},form:{width:'100%',// Fix IE 11 issue.\nmarginTop:theme.spacing(1)},submit:{margin:theme.spacing(3,0,2)}};});export default function Signin(){var _useState=useState({email:'',password:'',error:'',loading:false,redirectToReferrer:false}),_useState2=_slicedToArray(_useState,2),values=_useState2[0],setValues=_useState2[1];var email=values.email,password=values.password,loading=values.loading,error=values.error,redirectToReferrer=values.redirectToReferrer;var _isAuthenticated=isAuthenticated(),user=_isAuthenticated.user;var handleChange=function handleChange(name){return function(event){setValues(_objectSpread(_objectSpread({},values),{},_defineProperty({error:false},name,event.target.value)));};};var clickSubmit=function clickSubmit(event){event.preventDefault();// so that browser does not reload\nsetValues(_objectSpread(_objectSpread({},values),{},{error:false,loading:true}));signin({email:email,password:password}).then(function(data){if(data.error){setValues(_objectSpread(_objectSpread({},values),{},{error:data.error,loading:false}));}else{authenticate(data,function(){setValues(_objectSpread(_objectSpread({},values),{},{redirectToReferrer:true}));});}});};var showError=function showError(){return/*#__PURE__*/React.createElement(\"div\",{className:\"alert alert-danger\",style:{display:error?'':'none'}},error);};var showLoading=function showLoading(){return loading&&/*#__PURE__*/React.createElement(\"div\",{className:\"alert alert-info\"},/*#__PURE__*/React.createElement(\"h2\",null,\"Loading...\"));};var redirectUser=function redirectUser(){if(redirectToReferrer){if(user&&user.role===1){return/*#__PURE__*/React.createElement(Redirect,{to:\"/admin/dashboard\"});}else{return/*#__PURE__*/React.createElement(Redirect,{to:\"/user/dashboard\"});}}if(isAuthenticated()){return/*#__PURE__*/React.createElement(Redirect,{to:\"/\"});}};var classes=useStyles();var signInForm=function signInForm(){var _React$createElement;return/*#__PURE__*/React.createElement(Container,{component:\"main\",maxWidth:\"xs\"},showError(),showLoading(),redirectUser(),/*#__PURE__*/React.createElement(CssBaseline,null),/*#__PURE__*/React.createElement(\"div\",{className:classes.paper},/*#__PURE__*/React.createElement(Avatar,{className:classes.avatar},/*#__PURE__*/React.createElement(LockOutlinedIcon,null)),/*#__PURE__*/React.createElement(Typography,{component:\"h1\",variant:\"h5\"},\"Sign in\"),/*#__PURE__*/React.createElement(\"form\",{className:classes.form,noValidate:true},/*#__PURE__*/React.createElement(TextField,{variant:\"outlined\",margin:\"normal\",required:true,fullWidth:true,id:\"email\",label:\"Email Address\",name:\"email\",autoComplete:\"email\",onChange:handleChange('email'),type:\"email\",value:email,autoFocus:true}),/*#__PURE__*/React.createElement(TextField,(_React$createElement={variant:\"outlined\",margin:\"normal\",required:true,fullWidth:true,name:\"password\",label:\"Password\",type:\"password\",id:\"password\",onChange:handleChange('password')},_defineProperty(_React$createElement,\"type\",\"password\"),_defineProperty(_React$createElement,\"value\",password),_defineProperty(_React$createElement,\"autoComplete\",\"current-password\"),_React$createElement)),/*#__PURE__*/React.createElement(FormControlLabel,{control:/*#__PURE__*/React.createElement(Checkbox,{value:\"remember\",color:\"primary\"}),label:\"Remember me\"}),/*#__PURE__*/React.createElement(Button,{onClick:clickSubmit,type:\"submit\",fullWidth:true,variant:\"contained\",color:\"primary\",className:classes.submit},\"Sign In\"),/*#__PURE__*/React.createElement(Grid,{container:true},/*#__PURE__*/React.createElement(Grid,{item:true,xs:true},/*#__PURE__*/React.createElement(Link,{href:\"#\",variant:\"body2\"},\"Forgot password?\")),/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(Link,{to:\"/signup\",variant:\"body2\"},\"Don't have an account? Sign Up\"))))));};return/*#__PURE__*/React.createElement(Layout,{title:\"Signin page\",description:\"Signin to MERN E-commerce App\",className:\"container col-md-8 offset-md-2\"},signInForm(),/*#__PURE__*/React.createElement(Copyright,null));}","map":{"version":3,"sources":["D:/Dustin/racecity-frontend/src/user/Signin.js"],"names":["React","useState","Redirect","Link","Layout","Avatar","Button","CssBaseline","TextField","FormControlLabel","Checkbox","Grid","Box","LockOutlinedIcon","Typography","makeStyles","Container","Copyright","signin","authenticate","isAuthenticated","useStyles","theme","paper","marginTop","spacing","display","flexDirection","alignItems","avatar","margin","backgroundColor","palette","secondary","main","form","width","submit","Signin","email","password","error","loading","redirectToReferrer","values","setValues","user","handleChange","name","event","target","value","clickSubmit","preventDefault","then","data","showError","showLoading","redirectUser","role","classes","signInForm"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\r\nimport { Redirect, Link } from 'react-router-dom';\r\nimport Layout from '../core/Layout';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport Button from '@material-ui/core/Button';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Box from '@material-ui/core/Box';\r\nimport LockOutlinedIcon from '@material-ui/icons/LockOutlined';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Container from '@material-ui/core/Container';\r\n\r\nimport Copyright from '../core/Copyright';\r\nimport { signin, authenticate, isAuthenticated } from '../auth';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  paper: {\r\n    marginTop: theme.spacing(8),\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n  },\r\n  avatar: {\r\n    margin: theme.spacing(1),\r\n    backgroundColor: theme.palette.secondary.main,\r\n  },\r\n  form: {\r\n    width: '100%', // Fix IE 11 issue.\r\n    marginTop: theme.spacing(1),\r\n  },\r\n  submit: {\r\n    margin: theme.spacing(3, 0, 2),\r\n  },\r\n}));\r\n\r\nexport default function Signin() {\r\n  const [values, setValues] = useState({\r\n    email: '',\r\n    password: '',\r\n    error: '',\r\n    loading: false,\r\n    redirectToReferrer: false,\r\n  });\r\n\r\n  const { email, password, loading, error, redirectToReferrer } = values;\r\n  const { user } = isAuthenticated();\r\n\r\n  const handleChange = (name) => (event) => {\r\n    setValues({ ...values, error: false, [name]: event.target.value });\r\n  };\r\n\r\n  const clickSubmit = (event) => {\r\n    event.preventDefault(); // so that browser does not reload\r\n    setValues({ ...values, error: false, loading: true });\r\n    signin({ email, password }).then((data) => {\r\n      if (data.error) {\r\n        setValues({ ...values, error: data.error, loading: false });\r\n      } else {\r\n        authenticate(data, () => {\r\n          setValues({\r\n            ...values,\r\n            redirectToReferrer: true,\r\n          });\r\n        });\r\n      }\r\n    });\r\n  };\r\n\r\n  const showError = () => (\r\n    <div\r\n      className='alert alert-danger'\r\n      style={{ display: error ? '' : 'none' }}\r\n    >\r\n      {error}\r\n    </div>\r\n  );\r\n\r\n  const showLoading = () =>\r\n    loading && (\r\n      <div className='alert alert-info'>\r\n        <h2>Loading...</h2>\r\n      </div>\r\n    );\r\n\r\n  const redirectUser = () => {\r\n    if (redirectToReferrer) {\r\n      if (user && user.role === 1) {\r\n        return <Redirect to='/admin/dashboard' />;\r\n      } else {\r\n        return <Redirect to='/user/dashboard' />;\r\n      }\r\n    }\r\n    if (isAuthenticated()) {\r\n      return <Redirect to='/' />;\r\n    }\r\n  };\r\n\r\n  const classes = useStyles();\r\n\r\n  const signInForm = () => (\r\n    <Container component='main' maxWidth='xs'>\r\n      {showError()}\r\n      {showLoading()}\r\n      {redirectUser()}\r\n      <CssBaseline />\r\n      <div className={classes.paper}>\r\n        <Avatar className={classes.avatar}>\r\n          <LockOutlinedIcon />\r\n        </Avatar>\r\n        <Typography component='h1' variant='h5'>\r\n          Sign in\r\n        </Typography>\r\n        <form className={classes.form} noValidate>\r\n          <TextField\r\n            variant='outlined'\r\n            margin='normal'\r\n            required\r\n            fullWidth\r\n            id='email'\r\n            label='Email Address'\r\n            name='email'\r\n            autoComplete='email'\r\n            onChange={handleChange('email')}\r\n            type='email'\r\n            value={email}\r\n            autoFocus\r\n          />\r\n          <TextField\r\n            variant='outlined'\r\n            margin='normal'\r\n            required\r\n            fullWidth\r\n            name='password'\r\n            label='Password'\r\n            type='password'\r\n            id='password'\r\n            onChange={handleChange('password')}\r\n            type='password'\r\n            value={password}\r\n            autoComplete='current-password'\r\n          />\r\n          <FormControlLabel\r\n            control={<Checkbox value='remember' color='primary' />}\r\n            label='Remember me'\r\n          />\r\n          <Button\r\n            onClick={clickSubmit}\r\n            type='submit'\r\n            fullWidth\r\n            variant='contained'\r\n            color='primary'\r\n            className={classes.submit}\r\n          >\r\n            Sign In\r\n          </Button>\r\n          <Grid container>\r\n            <Grid item xs>\r\n              <Link href='#' variant='body2'>\r\n                Forgot password?\r\n              </Link>\r\n            </Grid>\r\n            <Grid item>\r\n              <Link to='/signup' variant='body2'>\r\n                {\"Don't have an account? Sign Up\"}\r\n              </Link>\r\n            </Grid>\r\n          </Grid>\r\n        </form>\r\n      </div>\r\n    </Container>\r\n  );\r\n\r\n  return (\r\n    <Layout\r\n      title='Signin page'\r\n      description='Signin to MERN E-commerce App'\r\n      className='container col-md-8 offset-md-2'\r\n    >\r\n      {signInForm()}\r\n      <Copyright />\r\n    </Layout>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}