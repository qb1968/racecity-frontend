{"ast":null,"code":"import _defineProperty from\"D:\\\\Dustin\\\\racecity-frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _objectSpread from\"D:\\\\Dustin\\\\racecity-frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"D:\\\\Dustin\\\\racecity-frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import Layout from'../core/Layout';import{isAuthenticated}from'../auth';import{Link,Redirect}from'react-router-dom';import{read,update,updateUser}from'./apiUser';var Profile=function Profile(_ref){var match=_ref.match;var _useState=useState({name:'',email:'',password:'',error:false,success:false}),_useState2=_slicedToArray(_useState,2),values=_useState2[0],setValues=_useState2[1];var _isAuthenticated=isAuthenticated(),token=_isAuthenticated.token;var name=values.name,email=values.email,password=values.password,error=values.error,success=values.success;var init=function init(userId){// console.log(userId);\nread(userId,token).then(function(data){if(data.error){setValues(_objectSpread(_objectSpread({},values),{},{error:true}));}else{setValues(_objectSpread(_objectSpread({},values),{},{name:data.name,email:data.email}));}});};useEffect(function(){init(match.params.userId);},[]);var handleChange=function handleChange(name){return function(e){setValues(_objectSpread(_objectSpread({},values),{},_defineProperty({error:false},name,e.target.value)));};};var clickSubmit=function clickSubmit(e){e.preventDefault();update(match.params.userId,token,{name:name,email:email,password:password}).then(function(data){if(data.error){// console.log(data.error);\nalert(data.error);}else{updateUser(data,function(){setValues(_objectSpread(_objectSpread({},values),{},{name:data.name,email:data.email,success:true}));});}});};var redirectUser=function redirectUser(success){if(success){return/*#__PURE__*/React.createElement(Redirect,{to:\"/user/dashboard\"});}};var profileUpdate=function profileUpdate(name,email,password){return/*#__PURE__*/React.createElement(\"form\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{className:\"text-muted\"},\"Name\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",onChange:handleChange('name'),className:\"form-control\",value:name})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{className:\"text-muted\"},\"Email\"),/*#__PURE__*/React.createElement(\"input\",{type:\"email\",onChange:handleChange('email'),className:\"form-control\",value:email})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{className:\"text-muted\"},\"Password\"),/*#__PURE__*/React.createElement(\"input\",{type:\"password\",onChange:handleChange('password'),className:\"form-control\",value:password})),/*#__PURE__*/React.createElement(\"button\",{onClick:clickSubmit,className:\"btn btn-primary\"},\"Submit\"));};return/*#__PURE__*/React.createElement(Layout,{title:\"Profile\",description:\"Update your profile\",className:\"container-fluid\"},/*#__PURE__*/React.createElement(\"h2\",{className:\"mb-4\"},\"Profile update\"),profileUpdate(name,email,password),redirectUser(success));};export default Profile;","map":{"version":3,"sources":["D:/Dustin/racecity-frontend/src/user/Profile.js"],"names":["React","useState","useEffect","Layout","isAuthenticated","Link","Redirect","read","update","updateUser","Profile","match","name","email","password","error","success","values","setValues","token","init","userId","then","data","params","handleChange","e","target","value","clickSubmit","preventDefault","alert","redirectUser","profileUpdate"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport Layout from '../core/Layout';\r\nimport { isAuthenticated } from '../auth';\r\nimport { Link, Redirect } from 'react-router-dom';\r\nimport { read, update, updateUser } from './apiUser';\r\n\r\nconst Profile = ({ match }) => {\r\n  const [values, setValues] = useState({\r\n    name: '',\r\n    email: '',\r\n    password: '',\r\n    error: false,\r\n    success: false,\r\n  });\r\n\r\n  const { token } = isAuthenticated();\r\n  const { name, email, password, error, success } = values;\r\n\r\n  const init = (userId) => {\r\n    // console.log(userId);\r\n    read(userId, token).then((data) => {\r\n      if (data.error) {\r\n        setValues({ ...values, error: true });\r\n      } else {\r\n        setValues({ ...values, name: data.name, email: data.email });\r\n      }\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    init(match.params.userId);\r\n  }, []);\r\n\r\n  const handleChange = (name) => (e) => {\r\n    setValues({ ...values, error: false, [name]: e.target.value });\r\n  };\r\n\r\n  const clickSubmit = (e) => {\r\n    e.preventDefault();\r\n    update(match.params.userId, token, { name, email, password }).then(\r\n      (data) => {\r\n        if (data.error) {\r\n          // console.log(data.error);\r\n          alert(data.error);\r\n        } else {\r\n          updateUser(data, () => {\r\n            setValues({\r\n              ...values,\r\n              name: data.name,\r\n              email: data.email,\r\n              success: true,\r\n            });\r\n          });\r\n        }\r\n      }\r\n    );\r\n  };\r\n\r\n  const redirectUser = (success) => {\r\n    if (success) {\r\n      return <Redirect to='/user/dashboard' />;\r\n    }\r\n  };\r\n\r\n  const profileUpdate = (name, email, password) => (\r\n    <form>\r\n      <div className='form-group'>\r\n        <label className='text-muted'>Name</label>\r\n        <input\r\n          type='text'\r\n          onChange={handleChange('name')}\r\n          className='form-control'\r\n          value={name}\r\n        />\r\n      </div>\r\n      <div className='form-group'>\r\n        <label className='text-muted'>Email</label>\r\n        <input\r\n          type='email'\r\n          onChange={handleChange('email')}\r\n          className='form-control'\r\n          value={email}\r\n        />\r\n      </div>\r\n      <div className='form-group'>\r\n        <label className='text-muted'>Password</label>\r\n        <input\r\n          type='password'\r\n          onChange={handleChange('password')}\r\n          className='form-control'\r\n          value={password}\r\n        />\r\n      </div>\r\n\r\n      <button onClick={clickSubmit} className='btn btn-primary'>\r\n        Submit\r\n      </button>\r\n    </form>\r\n  );\r\n\r\n  return (\r\n    <Layout\r\n      title='Profile'\r\n      description='Update your profile'\r\n      className='container-fluid'\r\n    >\r\n      <h2 className='mb-4'>Profile update</h2>\r\n      {profileUpdate(name, email, password)}\r\n      {redirectUser(success)}\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default Profile;\r\n"]},"metadata":{},"sourceType":"module"}